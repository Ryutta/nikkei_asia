# Cookieの取得と設定方法

Nikkei Asiaの有料会員限定記事（全文）を取得するには、ブラウザでログインした状態の「Cookie（クッキー）」情報をスクリプトに渡す必要があります。

## 1. Cookieの取得手順

1.  **ブラウザでログイン**:
    Google Chromeなどのブラウザで [Nikkei Asia](https://asia.nikkei.com/) にアクセスし、会員アカウントでログインしてください。

2.  **開発者ツールの起動**:
    ページ上の任意の場所で右クリックし、「検証 (Inspect)」を選択するか、F12キーを押して開発者ツールを開きます。

3.  **Applicationタブを開く**:
    開発者ツールの上部メニューから「Application」タブを選択します（隠れている場合は `>>` アイコンをクリックして探してください）。

4.  **Cookieを探す**:
    左側のサイドバーにある「Cookies」を展開し、`https://asia.nikkei.com` を選択します。

5.  **Cookie情報のコピー**:
    右側のリストに表示されるCookie情報をすべてコピーする必要がありますが、手動で1つずつコピーするのは大変です。

    **推奨される簡単な方法:**
    「Network」タブを使用する方法が確実です。
    1.  開発者ツールの「Network」タブに切り替えます。
    2.  ブラウザを再読み込み（リロード）します。
    3.  Networkタブのリストの一番上にある `asia.nikkei.com`（または `index`、`article` などのドキュメントリクエスト）をクリックします。
    4.  右側のパネルで「Headers」タブを選択します。
    5.  「Request Headers」セクションを探し、「Cookie:」という項目を見つけます。
    6.  その値（`_ga=...` から始まる非常に長い文字列）をすべて選択してコピーします。

## 2. スクリプトへの設定方法

Rスクリプトは `NIKKEI_COOKIE` という環境変数を読み込むように設計されています。

### 方法A: `.Renviron` ファイルを使用する（推奨）

プロジェクトのルートディレクトリに `.Renviron` という名前のファイルを作成し、以下のように記述します。

```bash
NIKKEI_COOKIE="ここにコピーしたCookie文字列を貼り付け"
```

※ `.Renviron` ファイルを変更した後は、Rセッションを再起動する必要があります。

### 方法B: Rコンソールで一時的に設定する

RStudioのコンソールで以下のコマンドを実行してから、スクリプトを実行します。

```r
Sys.setenv(NIKKEI_COOKIE = "ここにコピーしたCookie文字列を貼り付け")
source("scrape_nikkei.R")
```

## 3. PDF出力について

スクリプトは全記事をまとめたPDFファイル (`nikkei_full_report.pdf`) を生成しようとします。
これには `pandoc` が必要ですが、RStudioを使用している場合は通常インストールされています。
もしPDF生成に失敗した場合は、Markdownファイル (`nikkei_full_report.md`) が代わりに生成されます。これをNotebookLMに読み込ませることも可能です。
